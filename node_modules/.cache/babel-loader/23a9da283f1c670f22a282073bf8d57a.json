{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nimport set from 'lodash/set';\nimport removeEmpty from '../../util/removeEmpty';\nimport removeKey from '../../util/removeKey';\nexport var SET_SORT = 'SET_SORT';\nexport var SORT_ASC = 'ASC';\nexport var SORT_DESC = 'DESC';\nexport var SET_PAGE = 'SET_PAGE';\nexport var SET_PER_PAGE = 'SET_PER_PAGE';\nexport var SET_FILTER = 'SET_FILTER';\nexport var SHOW_FILTER = 'SHOW_FILTER';\nexport var HIDE_FILTER = 'HIDE_FILTER';\nvar oppositeOrder = function (direction) {\n  return direction === SORT_DESC ? SORT_ASC : SORT_DESC;\n};\n/**\n * This reducer is for the react-router query string.\n */\nexport var queryReducer = function (previousState, action) {\n  var _a;\n  switch (action.type) {\n    case SET_SORT:\n      if (action.payload.field === previousState.sort) {\n        return __assign(__assign({}, previousState), {\n          order: oppositeOrder(previousState.order),\n          page: 1\n        });\n      }\n      return __assign(__assign({}, previousState), {\n        sort: action.payload.field,\n        order: action.payload.order || SORT_ASC,\n        page: 1\n      });\n    case SET_PAGE:\n      return __assign(__assign({}, previousState), {\n        page: action.payload\n      });\n    case SET_PER_PAGE:\n      return __assign(__assign({}, previousState), {\n        page: 1,\n        perPage: action.payload\n      });\n    case SET_FILTER:\n      {\n        return __assign(__assign({}, previousState), {\n          page: 1,\n          filter: action.payload.filter,\n          displayedFilters: action.payload.displayedFilters ? action.payload.displayedFilters : previousState.displayedFilters\n        });\n      }\n    case SHOW_FILTER:\n      {\n        if (previousState.displayedFilters && previousState.displayedFilters[action.payload.filterName]) {\n          // the filter is already shown\n          return previousState;\n        }\n        return __assign(__assign({}, previousState), {\n          filter: typeof action.payload.defaultValue !== 'undefined' ? set(previousState.filter, action.payload.filterName, action.payload.defaultValue) : previousState.filter,\n          // we don't use lodash.set() for displayed filters\n          // to avoid problems with compound filter names (e.g. 'author.name')\n          displayedFilters: __assign(__assign({}, previousState.displayedFilters), (_a = {}, _a[action.payload.filterName] = true, _a))\n        });\n      }\n    case HIDE_FILTER:\n      {\n        return __assign(__assign({}, previousState), {\n          filter: removeEmpty(removeKey(previousState.filter, action.payload)),\n          // we don't use lodash.set() for displayed filters\n          // to avoid problems with compound filter names (e.g. 'author.name')\n          displayedFilters: previousState.displayedFilters ? Object.keys(previousState.displayedFilters).reduce(function (filters, filter) {\n            var _a;\n            return filter !== action.payload ? __assign(__assign({}, filters), (_a = {}, _a[filter] = true, _a)) : filters;\n          }, {}) : previousState.displayedFilters\n        });\n      }\n    default:\n      return previousState;\n  }\n};\nexport default queryReducer;","map":{"version":3,"sources":["../../../../src/controller/list/queryReducer.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport set from 'lodash/set';\nimport removeEmpty from '../../util/removeEmpty';\nimport removeKey from '../../util/removeKey';\nexport var SET_SORT = 'SET_SORT';\nexport var SORT_ASC = 'ASC';\nexport var SORT_DESC = 'DESC';\nexport var SET_PAGE = 'SET_PAGE';\nexport var SET_PER_PAGE = 'SET_PER_PAGE';\nexport var SET_FILTER = 'SET_FILTER';\nexport var SHOW_FILTER = 'SHOW_FILTER';\nexport var HIDE_FILTER = 'HIDE_FILTER';\nvar oppositeOrder = function (direction) {\n    return direction === SORT_DESC ? SORT_ASC : SORT_DESC;\n};\n/**\n * This reducer is for the react-router query string.\n */\nexport var queryReducer = function (previousState, action) {\n    var _a;\n    switch (action.type) {\n        case SET_SORT:\n            if (action.payload.field === previousState.sort) {\n                return __assign(__assign({}, previousState), { order: oppositeOrder(previousState.order), page: 1 });\n            }\n            return __assign(__assign({}, previousState), { sort: action.payload.field, order: action.payload.order || SORT_ASC, page: 1 });\n        case SET_PAGE:\n            return __assign(__assign({}, previousState), { page: action.payload });\n        case SET_PER_PAGE:\n            return __assign(__assign({}, previousState), { page: 1, perPage: action.payload });\n        case SET_FILTER: {\n            return __assign(__assign({}, previousState), { page: 1, filter: action.payload.filter, displayedFilters: action.payload.displayedFilters\n                    ? action.payload.displayedFilters\n                    : previousState.displayedFilters });\n        }\n        case SHOW_FILTER: {\n            if (previousState.displayedFilters &&\n                previousState.displayedFilters[action.payload.filterName]) {\n                // the filter is already shown\n                return previousState;\n            }\n            return __assign(__assign({}, previousState), { filter: typeof action.payload.defaultValue !== 'undefined'\n                    ? set(previousState.filter, action.payload.filterName, action.payload.defaultValue)\n                    : previousState.filter, \n                // we don't use lodash.set() for displayed filters\n                // to avoid problems with compound filter names (e.g. 'author.name')\n                displayedFilters: __assign(__assign({}, previousState.displayedFilters), (_a = {}, _a[action.payload.filterName] = true, _a)) });\n        }\n        case HIDE_FILTER: {\n            return __assign(__assign({}, previousState), { filter: removeEmpty(removeKey(previousState.filter, action.payload)), \n                // we don't use lodash.set() for displayed filters\n                // to avoid problems with compound filter names (e.g. 'author.name')\n                displayedFilters: previousState.displayedFilters\n                    ? Object.keys(previousState.displayedFilters).reduce(function (filters, filter) {\n                        var _a;\n                        return filter !== action.payload\n                            ? __assign(__assign({}, filters), (_a = {}, _a[filter] = true, _a)) : filters;\n                    }, {})\n                    : previousState.displayedFilters });\n        }\n        default:\n            return previousState;\n    }\n};\nexport default queryReducer;\n//# sourceMappingURL=queryReducer.js.map"]},"metadata":{},"sourceType":"module"}